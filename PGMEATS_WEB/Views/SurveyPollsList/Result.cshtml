
@{
    ViewBag.Title = "Result";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style type="text/css">
    .div-body {
        flex: 1 1 auto;
        padding: 1rem
    }

    .p-4 {
        padding: 1.5rem !important
    }

    .align-items-center {
        align-items: center !important
    }

    .fw-bold {
        font-weight: 700 !important
    }
    .div-center {
        justify-content: center;
        display: flex;
        font-size:26px;
    }
</style>

<link rel="stylesheet" type="text/css" href="~/Scripts/jquery-ui-1.12.0-rc.2/jquery-ui.css">
<div id="content">
    <section id="widget-grid" class="">
        <div class="row">
            <article class="col-xs-12 col-md-12">
                <div class="jarviswidget jarviswidget-color-red" id="wid-id-1" data-widget-colorbutton="false"
                     data-widget-editbutton="false" data-widget-togglebutton="false" data-widget-deletebutton="false"
                     data-widget-custombutton="false" data-widget-collapsed="false" data-widget-sortable="false">
                    <header style="border-top-left-radius:8px; border-top-right-radius:8px">
                        <h2 style="font-family:'Poppins-Regular';font-weight:500;font-size:15px">
                            Result of Survey and Polls
                        </h2>
                    </header>

                    <div style="border-bottom-left-radius:8px; border-bottom-right-radius:8px">
                        <div class="col-lg-12" style="display:flex; justify-content:center;">
                            <div style="width: 100%;">
                                @*<div class="div-body p-4">
                                    <div class="row align-items-center">
                                        <div class="col-lg-12">
                                            <h3 class="fw-bold" style="z-index: 99 !important; position: relative; display: flex; justify-content: left;">By Employee</h3>

                                            <div id="fill-by-employee" style="position: relative;">
                                                <div id="piechart" tyle="width: 700px;"></div>
                                            </div>

                                            <h3 class="fw-bold" style="z-index: 99 !important; position: relative; display: flex; justify-content: left;">By Department</h3>
                                            <div id="fill-by-department" style="position: relative;">
                                                <div id="by-department" tyle="width: 700px;"></div>
                                            </div>
                                            <h3 class="fw-bold" style="z-index: 99 !important; position: relative; display: flex; justify-content: left;">By Shift</h3>
                                            <div id="fill-by-Shift" style="position: relative">
                                                <div id="by-Shift" tyle="width: 700px;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>*@

                                @if (ViewBag.AnswerCheck == "True")
                                {
                                <div class="div-body p-4">
                                    
                                    <div id="result-title" style="padding:5px 5px 0px 0px; display:flex;">
                                        <p style="line-height:normal;margin-bottom:0px !important; width:100%">
                                            <span id="spnTitle" style="font-size: 20pt; font-family: Arial,sans-serif; color: black; font-weight: bold;">
                                                @ViewBag.SurveyTitle
                                            </span>
                                        </p>
                                        <div style="width:400px; display:flex">
                                            <button type="button" class="btn btn-save" id="btnExcel" style="font-family: 'Poppins-Regular'; font-size: 15px; font-weight: bold; color: #ffffff; background-color: #4CBFBC; width: 150px; float: right; margin-right:10px;" onclick="exportToExcel()">Excel</button>
                                            <button type="button" class="btn btn-save" id="btnexport" style="font-family: 'Poppins-Regular'; font-size: 15px; font-weight: bold; color: #ffffff; background-color: #4CBFBC; width: 150px; float: right; margin-right:10px;" onclick="window.print()">Print</button>
                                            <button type="button" class="btn btn-save" id="btnBack" style="font-family: 'Poppins-Regular'; font-size: 15px; font-weight: bold;color:#ffffff; background-color: #4CBFBC; width:150px; float:right; right:0" onclick="back()">Back</button>
                                        </div>
                                    </div>
                                    <div id="result-infouser" style="padding-left: 3px;">
                                        <p style="font-family: Arial,sans-serif;color: black; margin-bottom:20px; padding:0px 0px 0px 0px;">
                                            <i class="bi bi-person-fill"></i>
                                            @ViewBag.InfoUser
                                        </p>
                                    </div>
                                    <div class="row align-items-center">
                                        <h3 class="fw-bold" style="z-index: 99 !important; position: relative; display: flex; justify-content: left; margin-bottom: 0px !important; margin-top: 0px !important; margin-left: 10px; font-size: 16px; font-weight: normal !important; ">
                                            @ViewBag.Responses
                                        </h3>
                                    </div>
                                    <div class="row align-items-center">
                                        <div class="col-lg-12">
                                            <h3 class="fw-bold" style="z-index: 99 !important; position: relative; display: flex; justify-content: left; margin-bottom:0px !important;">By Employee</h3>

                                            <div id="fill-by-employee" style="position: relative;">
                                                <div id="piechart" style="width:100%; height: 500px;"></div>
                                            </div>

                                            <h3 class="fw-bold" style="z-index: 99 !important; position: relative; display: flex; justify-content: left; margin-bottom: 0px !important;">By Department</h3>
                                            <div id="fill-by-department" style="position: relative;">
                                                <div id="participant_byDept" style="width: 100%; height: 700px; margin-top: 0px; "></div>
                                                <div id="by-department" style="width: 100%; height: 700px; margin-top: 0px; "></div>
                                            </div>
                                            <h3 class="fw-bold" style="z-index: 99 !important; position: relative; display: flex; justify-content: left; margin-bottom: 0px !important;">By Shift</h3>
                                            <div id="fill-by-Shift" style="position: relative">
                                                <div id="participant_byShift" style="width: 100%; height: 500px; margin-top: 0px; "></div>
                                                <div id="by-Shift" style="width: 100%; height: 100vh; margin-top: 0px; "></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                }
                                else
                                {
                                    <div class="div-body p-4">
                                        <div style="display:block;">
                                            <div class="div-center">
                                                <span class="fa fa-search mb-3" style="font-size:50px"></span>
                                            </div>
                                            <div class="div-center">
                                                <p>No Result</p>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>

                </div>
            </article>
        </div>
    </section>
</div>

<script src="~/Scripts/plugin/bootstrap-waitingfor/bootstrap-waitingfor.min.js"></script>
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
@*<script src="~/Scripts/jquery-3.4.1.min.js"></script>*@
<script src="~/Scripts/bootstrap/bootstrap.min.js"></script>
<script src="~/Scripts/jquery-ui-1.12.0-rc.2/jquery-ui.js"></script>
<script src="~/Scripts/gstatic.js"></script>
<script src="~/Scripts/chart.js"></script>
@*<script src="~/Scripts/result.js"></script>*@
<script src="~/Scripts/plugin/summernote/summernote.min.js"></script>
@section pagespecific
{
    <script>
        var surveyID = '@ViewBag.SurveyID';

        $(document).ready(function myfunction() {

            // Load google charts
            //drawChart();
            google.charts.load('current', { 'packages': ['corechart'] });
            google.charts.setOnLoadCallback(drawChart);
            google.charts.setOnLoadCallback(getchartByParticipantDept);
            /*google.charts.setOnLoadCallback(getchartByDepartment);*/
            google.charts.setOnLoadCallback(getchartByDepartment_isStacked);
            google.charts.setOnLoadCallback(getchartByParticipantShift);
            google.charts.setOnLoadCallback(getchartByShift);
        });

        // Draw the chart and set the chart values
        function drawChart() {
            var htmlsList = "";
            var obj = { 'SurveyID': surveyID };
            $.ajax({
                url: "@Url.Action("getchartheaderbyemployee", "SurveyPollsList")",
                type: "post",
                dataType: 'json',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(obj),
                success: function (data) {
                    $('#fill-by-employee').empty();
                    var pData = data[0].Contents;
                    if (data[0].ID == '1') {
                        toastr.warning(data[0].Message, 'Warning', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });
                    }
                    else {
                        var pdata;
                        var options;
                        var dp = [];
                        $.each(data[0].Contents, function (i, dt) {
                            pdata = null;
                            options = null;
                            if (dt.QuestionID == 1) {
                                htmlsList = '<div id="piechart_' + dt.QuestionID + '" style="margin-bottom: 0px;margin-top:0px; width:100%; height: 500px;"></div>';
                            } else {
                                htmlsList = '<div id="piechart_' + dt.QuestionID + '" style="margin-bottom: 0px; width:100%; height: 500px;"></div>';
                            }
                            $('#fill-by-employee').append(htmlsList);
                            var pObj = { 'SurveyID': dt.SurveyID, 'QuestionID': dt.QuestionID };
                            var qsID = dt.QuestionID;
                            $.ajax({
                                type: "POST",
                                url: "@Url.Action("getchartbyemployee", "SurveyPollsList")",
                                dataType: 'json',
                                contentType: 'application/json; charset=utf-8',
                                data: JSON.stringify(pObj),
                                success: function (data) {
                                    var o = 0;
                                    dp = []
                                    if (data[0].Contents.length == 0) {
                                        var ps = []
                                        if (o == 0) {
                                            ps = ['Survey', 'Population']
                                            dp.push(ps)
                                        }
                                        var x = ['No data', 0]
                                        dp.push(x);
                                    }
                                    $.each(data[0].Contents, function (i, dt) {
                                        var p = []
                                        if (o == 0) {
                                            p = ['Survey', 'Population']
                                            dp.push(p)
                                        }
                                        var x = ['' + dt.AnswerDesc + '', dt.Sub_total]
                                        dp.push(x);
                                        o += 1;
                                    });
                                },
                                error: function (ex) {
                                    toastr.error('Failed to retrieve this Data. ' + ex, 'Error', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });

                                }
                            }).done(function () {
                                pdata = google.visualization.arrayToDataTable(dp);
                                options = {
                                    'title': dt.QuestionDesc //,
                                    //'width': 700,
                                    //'height': 400,
                                    //'legend': 'none',
                                    //'crosshair': { trigger: 'both' },
                                    //'tooltip': {
                                    //    trigger: 'selection'
                                    //}
                                };

                                //crosshair: { trigger: 'both' },   // Display crosshairs.
                                //tooltip: { trigger: 'selection' } // Display tooltips on selection.
                                var id = "piechart_" + dt.QuestionID;

                                var chart = new google.visualization.PieChart(document.getElementById(id));
                                //var imgID = "Imgpiechart_" + dt.QuestionID;
                                //var chart_div = document.getElementById(id);
                                //google.visualization.events.addListener(chart, 'ready', function () {
                                //    chart_div.innerHTML = '<img id="' + imgID + '" src="' + chart.getImageURI() + '">';
                                //});
                                chart.draw(pdata, options);

                            });

                        });
                    }
                },
                error: function (ex) {
                    toastr.error('Failed to retrieve this Data. ' + ex, 'Error', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });

                }
            });
        }

        function getchartByParticipantDept() {
            var htmlsList = "";
            var obj = { 'SurveyID': surveyID };
            var pData = []

            $.ajax({
                type: "POST",
                url: "@Url.Action("GetchartByParticipantDept", "SurveyPollsList")",
                dataType: 'json',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(obj),
                success: function (data) {
                    var oi = 0
                    var participants
                    $.each(data[0].Contents, function (i, dt) {
                        var xData = []; //= { dt.Department, dt.Total }
                        if (oi == 0) {
                            xData = [dt.Department, dt.Total, { type: 'string', role: 'annotation' }]
                            participants = Number(dt.TotalParticipant);
                        } else {
                            xData = [ dt.Department, Number(dt.Total), dt.Percentage ]
                        }

                        pData.push(xData)
                        oi += 1;
                    })
                    var pVal = google.visualization.arrayToDataTable(pData);
                    var options = {
                        title: 'Staff participation',
                        chartArea: { width: '50%' },
                        annotations: {
                            alwaysOutside: false,
                            textStyle: {
                                fontSize: 12,
                                auraColor: 'none',
                                color: '#555'
                            },
                            boxStyle: {
                                stroke: '#ccc',
                                strokeWidth: 1,
                                gradient: {
                                    color1: '#f3e5f5',
                                    color2: '#f3e5f5',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%'
                                }
                            }
                        },
                        hAxis: {
                            minValue: 0, maxValue: participants
                        },
                        legend: { position: 'none' }
                    };
                    var chart = new google.visualization.BarChart(document.getElementById('participant_byDept'));
                    chart.draw(pVal, options);
                },
                error: function (ex) {
                    toastr.error('Failed to retrieve this Data. ' + ex, 'Error', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });
                }
            });
        }

        function getchartByDepartment() {
            var htmlsList = "";
            var obj = { 'SurveyID': surveyID };
            $.ajax({
                type: "POST",
                url: "@Url.Action("getchartByDepartment", "SurveyPollsList")",
                dataType: 'json',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(obj),
                success: function (data) {
                    var pDept = data[0].Contents;
                    var lastCol;
                    if (data[0].ID == '1') {
                        toastr.warning(data[0].Message, 'Warning', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });
                    }
                    else {
                        var datd = new google.visualization.DataTable();
                        var deptbefore = '';
                        var pHeader = ['Department']
                        var pContent = []
                        var pData = []
                        $.ajax({
                            type: "POST",
                            url: "@Url.Action("Getlabel", "SurveyPollsList")",
                            dataType: 'json',
                            contentType: 'application/json; charset=utf-8',
                            data: JSON.stringify(obj),
                            success: function (data) {
                                $.each(data[0].Contents, function (i, dt) {
                                    pHeader.push(dt.AnswerDesc)
                                    lastCol = dt.LastCol;
                                })
                            },
                            error: function (ex) {
                                toastr.error('Failed to retrieve this Data. ' + ex, 'Error', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });
                            }
                        }).done(function () {
                            pData.push(pHeader)
                            var depart;
                            var val;
                            var pval = []
                            var o = 0
                            var oj = data[0].Contents

                            for (s = 0; s < pDept.length; s++) {
                                const result = Object.keys(pDept[s]).reduce((prev, curr) => {
                                    prev.push(pDept[s][curr]);
                                    return prev;
                                }, []);

                                pData.push(result)
                            }

                            var pVal = google.visualization.arrayToDataTable(pData);
                            var options = { 'title': 'Question & Answer', 'chartArea': { width: '50%' } }; /*, 'width': 700, 'height': 400 };*/

                            var chart = new google.visualization.BarChart(document.getElementById('by-department'));
                            //var imgID = "Imgdepartment";
                            //var chart_div = document.getElementById('by-department');
                            //google.visualization.events.addListener(chart, 'ready', function () {
                            //    chart_div.innerHTML = '<img id="' + imgID + '" src="' + chart.getImageURI() + '">';
                            //});
                            chart.draw(pVal, options);
                        });
                    }
                },
                error: function (ex) {
                    toastr.error('Failed to retrieve this Data. ' + ex, 'Error', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });

                }
            });
        }

        //New isStacked
        function getchartByDepartment_isStacked() {
            var htmlsList = "";
            var obj = { 'SurveyID': surveyID };
            var pData = []
            $.ajax({
                type: "POST",
                url: "@Url.Action("getchartByDepartmentisStacked", "SurveyPollsList")",
                dataType: 'json',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(obj),
                success: function (data) {
                    var oi = 0
                    var participants

                    $.each(data[0].Contents, function (i, dt) {
                        var xData = []; //= { dt.Department, dt.Total }
                        var xstr = dt.Array.split(",");
                        for (ii = 0; ii < xstr.length; ii++) {
                            if (i == 0) {
                                xData.push(xstr[ii])
                            } else {
                                if (ii > 0) {
                                    xData.push(Number(xstr[ii]))
                                } else {
                                    xData.push(xstr[ii])
                                }
                            }
                        }
                        //var xData = JSON.stringify(dt.Array)
                        //if (oi == 0) {
                        //    xData = [dt.Shift, dt.Total, { type: 'string', role: 'annotation' }]
                        //    participants = Number(dt.TotalParticipant);
                        //} else {
                        //    xData = [dt.Shift, Number(dt.Total), dt.Percentage]
                        //}

                        pData.push(xData)
                        oi += 1;
                    })

                    var pVal = google.visualization.arrayToDataTable(pData);

                    var options = {
                        title: 'Question & Answer',
                        isStacked: true,
                        width: '100%', //pdata.getNumberOfRows() * 65,
                        bar: { groupWidth: '70%' },
                        chartArea: { width: '50%'}
                    };
                    var chart = new google.visualization.BarChart(document.getElementById('by-department'));
                    chart.draw(pVal, options);
                },
                error: function (ex) {
                    toastr.error('Failed to retrieve this Data. ' + ex, 'Error', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });
                }
            });
        }

        function getchartByParticipantShift() {
            var htmlsList = "";
            var obj = { 'SurveyID': surveyID };
            var pData = []
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetchartByParticipantShift", "SurveyPollsList")",
                dataType: 'json',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(obj),
                success: function (data) {
                    var oi = 0
                    var participants
                    $.each(data[0].Contents, function (i, dt) {
                        var xData = []; //= { dt.Department, dt.Total }
                        if (oi == 0) {
                            xData = [dt.Shift, dt.Total, { type: 'string', role: 'annotation' }]
                            participants = Number(dt.TotalParticipant);
                        } else {
                            xData = [ dt.Shift, Number(dt.Total), dt.Percentage ]
                        }

                        pData.push(xData)
                        oi += 1;
                    })
                    var pVal = google.visualization.arrayToDataTable(pData);
                    var options = {
                        title: 'Staff participation',
                        chartArea: { width: '50%' },
                        bar: { groupWidth: "35%" },
                        annotations: {
                            alwaysOutside: false,
                            textStyle: {
                                fontSize: 12,
                                auraColor: 'none',
                                color: '#555'
                            },
                            boxStyle: {
                                stroke: '#ccc',
                                strokeWidth: 1,
                                gradient: {
                                    color1: '#f3e5f5',
                                    color2: '#f3e5f5',
                                    x1: '0%', y1: '0%',
                                    x2: '100%', y2: '100%'
                                }
                            }
                        },
                        hAxis: {
                            minValue: 0, maxValue: participants
                        },
                        legend: { position: 'none' }
                    };
                    var chart = new google.visualization.BarChart(document.getElementById('participant_byShift'));
                    chart.draw(pVal, options);
                },
                error: function (ex) {
                    toastr.error('Failed to retrieve this Data. ' + ex, 'Error', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });
                }
            });
        }

        function getchartByShift() {
            var htmlsList = "";
            var obj = { 'SurveyID': surveyID };
            $.ajax({
                type: "POST",
                url: "@Url.Action("getchartByShift", "SurveyPollsList")",
                dataType: 'json',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(obj),
                success: function (Result) {
                    var pShift = Result[0].Contents;

                    var lastCol;
                    if (Result[0].ID == '1') {
                        toastr.warning(Result[0].Message, 'Warning', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });
                    }
                    else {
                        var datd = new google.visualization.DataTable();
                        var Shiftbefore = '';
                        var pHeader = ['Shift']
                        var pContent = []
                        var pData = []
                        $.ajax({
                            type: "POST",
                            url: "@Url.Action("Getlabel", "SurveyPollsList")",
                            dataType: 'json',
                            contentType: 'application/json; charset=utf-8',
                            data: JSON.stringify(obj),

                            success: function (data) {
                                $.each(data[0].Contents, function (i, dt) {
                                    pHeader.push(dt.AnswerDesc)
                                    lastCol = dt.LastCol;
                                })
                            },
                            error: function (ex) {
                                toastr.error('Failed to retrieve this Data. ' + ex, 'Error', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });
                            }
                        }).done(function () {
                            pData.push(pHeader)
                            var depart;
                            var val;
                            var pval = []
                            var o = 0
                            var oj = Result[0].Contents
                            for (s = 0; s < pShift.length; s++) {
                                const result = Object.keys(pShift[s]).reduce((prev, curr) => {
                                    prev.push(pShift[s][curr]);
                                    return prev;
                                }, []);

                                pData.push(result)
                            }
                            var pVal = google.visualization.arrayToDataTable(pData);
                            var options = { 'title': 'Question & Answer', 'chartArea': { width: '50%' }  }; /*, 'width': 700, 'height': 400 };*/

                            var chart = new google.visualization.BarChart(document.getElementById('by-Shift'));
                            //var imgID = "ImgdShift";
                            //var chart_div = document.getElementById('by-Shift');
                            //google.visualization.events.addListener(chart, 'ready', function () {
                            //    chart_div.innerHTML = '<img id="' + imgID + '" src="' + chart.getImageURI() + '">';
                            //});
                            chart.draw(pVal, options);
                        });
                    }

                },
                error: function (ex) {
                    toastr.error('Failed to retrieve this Data. ' + ex, 'Error', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });

                }
            });
        }

        function back() {
            var url = "/SurveyPollsList/Index?back=1";
            //var url = "/MyPGM_Web/SurveyPollsList/Index?back=1";
            window.location.href = url;
        }

        //function print() {
        //    window.print();
        //}

        var exportToExcel = (function () {
            debugger;
            var uri = 'data:application/vnd.ms-excel;base64,'
                , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><div>{div}</div></html>'
                , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
                , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
            debugger;
            return function (images, name) {
                debugger;
                if (!images.nodeType)
                    images = $("img")
                debugger
                var html = "";
                for (i = 0; i < images.length; i++) {
                    if (images[i].id != "") {
                        if (images[i].id == "Imgpiechart_1") {
                            html += "<div><h1>By Employee</h1></div><br>"
                        }
                        if (images[i].id.split("_")[0] == "Imgdepartment") {
                            html += "<div><h1>By Department</h1></div><br>"
                        }
                        if (images[i].id.split("_")[0] == "ImgdShift") {
                            html += "<div><h1>By Shift</h1></div><br>"
                        }

                        const link = images[i].src;
                        /*html += '<div> <img src="' + images[i].src + '"></img></div><br>'*/
                        html += '<div> <img src="blob:null/8b8f2c34-8491-4581-88c2-98e905b60c06"></img></div><br>'
                       /* xID = images[i].id;*/
                    }
                }
                debugger
                var ctx = { worksheet: name || 'Worksheet', div: html }
                window.location.href = uri + base64(format(template, ctx))
            }
        })()

        function SaveBase64ToImg() {
            images = $("img")
            var data = [];
            for (i = 0; i < images.length; i++) {
                if (images[i].id != "") {
                    data.push({
                        nameID: images[i].id,
                        src: images[i].src
                    })
                }
            }
            var xObj = { 'obj': data };
            $.ajax({
                type: "POST",
                url: "@Url.Action("SaveBase64ToImg", "SurveyPollsList")",
                dataType: 'json',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(xObj),
                success: function (Result) {
                    if (Result[0].ID == '1') {
                        toastr.warning(Result[0].Message, 'Warning', { timeOut: 3000, closeButton: true, positionClass: "toast-top-full-width" });
                    } else {

                    }
                },
            });
        }

        //function convertToBase64(ArrayBuffer) {
        //    const uInt8Array = new Uint8Array(input);
        //    const count = uInt8Array.length;

        //    // Allocate the necessary space up front.
        //    const charCodeArray = new Array(count)[];

        //    // Convert every entry in the array to a character.
        //    for (let i = count; i >= 0; i--) {
        //        charCodeArray[i] = String.fromCharCode(uInt8Array[i]);
        //    }

        //    // Convert the characters to base64.
        //    const base64 = btoa(charCodeArray.join(''));
        //    return base64;
        //}
    </script>
    
}
